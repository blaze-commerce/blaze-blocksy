---
title: "Mix and Match Products Load More & Search Feature"
description: "Implementation of load more functionality and clientside search for Mix and Match products to improve user experience by showing products progressively and enabling quick product filtering."
category: "module"
last_updated: "2025-01-18"
framework: "wordpress-theme"
domain: "catalog"
layer: "frontend"
tags:
  [woocommerce, mix-and-match, load-more, search, javascript, css, debouncing]
---

# Overview

This module implements both "Load More" and "Search" features for WooCommerce Mix and Match products to improve user experience. Instead of displaying all products at once, only the first row of products is shown initially, with additional rows revealed when users click the "Load More" button. Additionally, users can search through products using a clientside search field.

The implementation consists of:

- CSS rules to hide products beyond the first row
- JavaScript functionality to progressively show hidden products
- PHP integration to add the load more button
- JavaScript-generated search field with proper positioning
- Clientside search with debouncing for performance
- Integration between search and load more modes

# Usage

The load more feature is automatically enabled for Mix and Match products that have more items than the configured number of columns.

## Automatic Integration

```php
// Both features are automatically loaded for Mix and Match products
// No manual initialization required
```

## Load More Feature

### CSS Classes

```css
/* Products are hidden using nth-child selectors with class-based override */
.mnm_child_products.products.columns-3
  li.product:nth-child(n + 4):not(.mnm-show) {
  display: none !important;
}

/* Force show products with mnm-show class */
.mnm_child_products.products li.product.mnm-show {
  display: block !important;
}
```

### JavaScript Interaction

```javascript
// Load more button click handler
$(".ct-mnm-load-more").on("click", function (e) {
  // Shows next row of products by adding .mnm-show class
  var productsToShow = hiddenProducts.slice(0, columns);
  productsToShow.addClass("mnm-show");
});
```

## Search Feature

### HTML Structure (Generated by JavaScript)

```html
<!-- Dynamically created and inserted before .mnm_child_products.products -->
<div class="mnm-search-container">
  <input
    type="text"
    class="mnm-search-field"
    placeholder="Search products..."
    aria-label="Search products"
    autocomplete="off"
  />
  <div class="mnm-search-no-results" style="display: none;">
    <p>No Products Found</p>
  </div>
</div>
```

### CSS Classes

```css
/* Search field styling */
.mnm-search-field {
  width: 100%;
  max-width: 400px;
  padding: 12px 16px;
  border: 2px solid #ddd;
  border-radius: 8px;
}

/* Hide products during search */
.mnm-search-hidden {
  display: none !important;
}

/* Search mode - hide load more button */
.mnm-search-mode .ct-mnm-load-more {
  display: none !important;
}
```

### JavaScript Interaction

```javascript
// Create search elements dynamically
function createSearchElements() {
  var searchContainer = $('<div class="mnm-search-container"></div>');
  var searchField = $(
    '<input type="text" class="mnm-search-field" placeholder="Search products..." aria-label="Search products" autocomplete="off">'
  );
  var noResultsMessage = $(
    '<div class="mnm-search-no-results" style="display: none;"><p>No Products Found</p></div>'
  );

  searchContainer.append(searchField);
  searchContainer.append(noResultsMessage);
  searchContainer.insertBefore(container); // Insert before products container
}

// Search with debouncing (500ms) using event delegation
$(document).on("input", ".mnm-search-field", function () {
  var searchTerm = $(this).val().trim();
  clearTimeout(searchTimeout);
  searchTimeout = setTimeout(function () {
    handleSearch(searchTerm);
  }, 500);
});

// Enter search mode: hide all products first
function enterSearchMode() {
  isSearchMode = true;
  container.addClass("mnm-search-mode");
  loadMoreButton.hide();

  // Hide all products first, then show only matching ones
  var allProducts = container.find("li.product");
  allProducts.addClass("mnm-search-hidden").hide();
}

// Filter products by title and variation data
function filterProducts(searchTerm) {
  var searchTermLower = searchTerm.toLowerCase();
  allProducts.each(function () {
    var product = $(this);
    var isMatch = false;

    // Search in product title
    var productTitle = product
      .find(".woocommerce-loop-product__title > a")
      .text()
      .toLowerCase();
    if (productTitle.includes(searchTermLower)) {
      isMatch = true;
    }

    // Search in variation data if title doesn't match
    if (!isMatch) {
      var variationValues = [];
      product.find(".product-details .variation dd").each(function () {
        variationValues.push($(this).text().trim().toLowerCase());
      });

      var variationText = variationValues.join(" ");
      if (variationText.includes(searchTermLower)) {
        isMatch = true;
      }
    }

    // Show only matching products (all products are already hidden)
    if (isMatch) {
      product.removeClass("mnm-search-hidden").addClass("mnm-show").show();
    }
    // Non-matching products remain hidden
  });
}
```

# Parameters

## PHP Configuration

| Parameter          | Type    | Default | Description                                 |
| ------------------ | ------- | ------- | ------------------------------------------- |
| `$default_columns` | integer | 3       | Number of columns from WooCommerce settings |
| `$child_items`     | array   | -       | Array of child products from Mix and Match  |

## CSS Variables

| Variable      | Default | Description                                  |
| ------------- | ------- | -------------------------------------------- |
| `columns-{n}` | -       | CSS class indicating number of columns (1-6) |

## JavaScript Data Attributes

| Attribute      | Type    | Description                       |
| -------------- | ------- | --------------------------------- |
| `data-columns` | integer | Number of columns passed from PHP |

## Search Configuration

| Parameter         | Type    | Default                                                                      | Description                                   |
| ----------------- | ------- | ---------------------------------------------------------------------------- | --------------------------------------------- |
| `searchTimeout`   | integer | 500ms                                                                        | Debounce delay for search input               |
| `minSearchLength` | integer | 3                                                                            | Minimum characters required to trigger search |
| `searchTargets`   | array   | `[".woocommerce-loop-product__title > a", ".product-details .variation dd"]` | Elements containing searchable data           |

# Returns

## CSS Behavior

- Hides products beyond the first row based on column configuration
- Shows/hides load more button styling states

## JavaScript Behavior

- Shows next row of products when load more is clicked
- Updates button state when all products are loaded
- Returns void

# Dependencies

## Internal Dependencies

- WooCommerce Mix and Match plugin
- jQuery library
- WordPress theme structure

## External Dependencies

- WooCommerce core functionality
- Mix and Match plugin (`WC_MNM_PLUGIN_FILE`)

## CSS Dependencies

```css
/* Requires these base classes from Mix and Match plugin */
.mnm_child_products.products
.mnm_child_products.products.columns-{n}
li.product
```

## JavaScript Dependencies

```javascript
// Requires jQuery
// Requires WooCommerce Mix and Match DOM structure
```

# Testing

## Manual Testing Steps

1. **Setup Test Environment**

```bash
# Ensure Mix and Match plugin is active
# Create a Mix and Match product with more than 3 child products
```

2. **Test Initial Load**

```javascript
// Check that only first row of products is visible
console.log($(".mnm_child_products.products li.product:visible").length);
// Should equal the number of columns (default 3)
// Verify search field is present
console.log($(".mnm-search-field").length); // Should be 1
```

3. **Test Search Functionality**

```javascript
// Test minimum character requirement
$(".mnm-search-field").val("ab").trigger("input");
// Should not trigger search (less than 3 characters)

// Test product title search
$(".mnm-search-field").val("delta").trigger("input");
// Wait 500ms for debouncing, then check results
setTimeout(() => {
  console.log(
    "Visible products:",
    $(".mnm_child_products.products li.product:visible").length
  );
  console.log("Load more hidden:", $(".ct-mnm-load-more").is(":hidden"));
}, 600);

// Test variation data search
$(".mnm-search-field").val("blackberry").trigger("input"); // Search for strain
// Or search for amount
$(".mnm-search-field").val("20 grams").trigger("input");

// Test search for products in rows beyond first row
$(".mnm-search-field").val("strawberry").trigger("input"); // Should find products even if they're in row > 1
setTimeout(() => {
  var matchingProducts = $(
    ".mnm_child_products.products li.product:visible"
  ).length;
  console.log("Products found with 'strawberry':", matchingProducts);

  // Check if any products beyond first row are now visible
  var allProducts = $(".mnm_child_products.products li.product").length;
  if (matchingProducts > 0) {
    console.log("✅ Search working - found products in any row");
  } else {
    console.log("❌ Search bug - products in row > 1 not found");
  }
}, 600);
```

4. **Test Search Clear (Critical Test)**

```javascript
// First, perform a search to enter search mode
$(".mnm-search-field").val("delta").trigger("input");
setTimeout(() => {
  console.log(
    "Search mode - Visible products:",
    $(".mnm_child_products.products li.product:visible").length
  );

  // Then clear search field
  $(".mnm-search-field").val("").trigger("input");

  // Wait 500ms, verify load more returns and products reset to first row only
  setTimeout(() => {
    var visibleProducts = $(
      ".mnm_child_products.products li.product:visible"
    ).length;
    var totalProducts = $(".mnm_child_products.products li.product").length;

    console.log(
      "After reset - Load more visible:",
      $(".ct-mnm-load-more").is(":visible")
    );
    console.log("After reset - Visible products:", visibleProducts);
    console.log("After reset - Total products:", totalProducts);

    // Should show only first row (typically 2-3 products based on columns)
    // If visibleProducts equals totalProducts, the bug is still present
    if (visibleProducts < totalProducts) {
      console.log("✅ Reset working correctly - showing only first row");
    } else {
      console.log(
        "❌ Reset bug - all products visible instead of first row only"
      );
    }
  }, 600);
}, 600);
```

5. **Test No Results**

```javascript
// Search for non-existent product
$(".mnm-search-field").val("nonexistent").trigger("input");
// Wait 500ms, verify "No Products Found" message appears
setTimeout(() => {
  console.log(
    "No results message visible:",
    $(".mnm-search-no-results").is(":visible")
  );
}, 600);
```

6. **Test Load More Functionality**

```javascript
// Click load more button
$(".ct-mnm-load-more").click();
// Verify additional products become visible
```

7. **Test Complete Loading**

```javascript
// Continue clicking until all products are shown
// Verify button becomes disabled with "All products loaded" text
```

## Automated Testing

```javascript
// Test CSS hiding functionality
QUnit.test("Products beyond first row are hidden", function (assert) {
  var hiddenProducts = $(
    ".mnm_child_products.products.columns-3 li.product:nth-child(n + 4)"
  );
  assert.ok(
    hiddenProducts.css("display") === "none",
    "Products beyond first row are hidden"
  );
});

// Test load more functionality
QUnit.test("Load more shows additional products", function (assert) {
  var initialVisible = $(
    ".mnm_child_products.products li.product:visible"
  ).length;
  $(".ct-mnm-load-more").click();
  var afterClick = $(".mnm_child_products.products li.product:visible").length;
  assert.ok(afterClick > initialVisible, "More products visible after click");
});
```

## Browser Console Debugging

```javascript
// Enable debug logging in browser console
// Check for these log messages:
// "Mix and Match Load More script loaded"
// "Load more clicked, columns: X"
// "Hidden products found: X"
// "Showing X products"
```

# Changelog

## Version 1.0.0 (2025-01-18)

- Initial implementation of load more feature
- Added CSS rules to hide products beyond first row
- Implemented JavaScript click handler for progressive loading
- Added PHP integration to generate load more button
- Fixed CSS comment syntax issue (changed `//` to `/* */`)
- Added multiple CSS selector fallbacks for better compatibility
- Added debugging console logs for troubleshooting
- Added comprehensive error handling and fallback selectors

## Version 1.0.1 (2025-01-18)

- **CRITICAL FIX**: Resolved CSS `!important` preventing JavaScript `.show()` from working
- Implemented class-based approach using `.mnm-show` class for reliable show/hide functionality
- Updated JavaScript to use `addClass("mnm-show")` instead of `.show()` method
- Enhanced CSS selectors with `:not(.mnm-show)` to allow class-based overrides
- Improved debugging output to show visible vs hidden product counts

## Version 1.1.0 (2025-01-18)

- **NEW FEATURE**: Added clientside search functionality for Mix and Match products
- Implemented search field with 500ms debouncing for optimal performance
- Added minimum 3-character requirement for search activation
- Case-insensitive search targeting product titles
- Integrated search mode with load more functionality (hides load more during search)
- Added "No Products Found" message for empty search results
- Automatic reset to original state when search is cleared
- Enhanced CSS with search-specific classes and styling
- Updated documentation with comprehensive search feature coverage

## Version 1.1.1 (2025-01-18)

- **IMPLEMENTATION FIX**: Moved search field creation from PHP to JavaScript for proper positioning
- Used `insertBefore()` method to correctly place search field before products container
- Implemented dynamic element creation with retry mechanism for reliability
- Changed to event delegation for search input handling to support dynamically created elements
- Removed dependency on Mix and Match plugin hooks for search field placement

## Version 1.2.0 (2025-01-18)

- **NEW FEATURE**: Added variation data search capability
- Extended search functionality to include product variation values (Amount, Strain, etc.)
- Search now targets both product titles and variation data (`.product-details .variation dd`)
- Implemented intelligent search priority: title first, then variation data
- Added debug logging for variation data to help troubleshooting
- Enhanced search algorithm to handle multiple data sources efficiently

## Version 1.2.1 (2025-01-18)

- **CRITICAL BUG FIX**: Fixed search reset functionality
- Resolved issue where clearing search field resulted in no products being displayed
- Enhanced `resetProductsToOriginalState()` function to properly restore first-row visibility
- Added `allProducts.show()` to ensure CSS rules can properly hide products beyond first row
- Reset load more button state when exiting search mode
- Added comprehensive debug logging for reset process troubleshooting

## Version 1.2.2 (2025-01-18)

- **CRITICAL BUG FIX**: Fixed search not finding products in rows beyond first row
- Enhanced `enterSearchMode()` to properly reset all products visibility before filtering
- Added `addClass("mnm-show")` to all products when entering search mode to override CSS hiding rules
- Fixed `filterProducts()` to ensure matching products get proper visibility classes
- Added debug logging to track matching products and their variations
- Resolved issue where products with matching variations in row > 1 were not displayed in search results

## Version 1.2.3 (2025-01-18)

- **IMPLEMENTATION IMPROVEMENT**: Simplified search logic with cleaner approach
- Changed `enterSearchMode()` to hide all products first, then show only matching ones
- Removed complex CSS override logic in favor of simple hide-all-then-show-matches approach
- Simplified `filterProducts()` by removing redundant hide logic for non-matching products
- Improved search performance and reliability with more predictable behavior

## Bug Fixes

- **CSS Comments**: Fixed invalid `//` comment syntax in CSS file
- **Selector Specificity**: Added multiple CSS selector variations for better compatibility
- **JavaScript Robustness**: Added fallback selectors and debugging for better reliability
- **CSS Override Issue**: Fixed `!important` CSS preventing JavaScript `.show()` from working
- **Class-based Approach**: Implemented `.mnm-show` class system for reliable show/hide functionality

## Related Files

- `includes/customization/mix-and-match-products.php` - PHP integration
- `assets/css/mix-and-match-products.css` - Styling and hiding rules
- `assets/js/mix-and-match-products.js` - Load more functionality
