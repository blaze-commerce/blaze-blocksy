<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recently Viewed Products - Demo Testing</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .demo-section {
            background: #f9f9f9;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            border: 1px solid #ddd;
        }
        .button {
            background: #007cba;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .button:hover {
            background: #005a87;
        }
        .button.secondary {
            background: #666;
        }
        .button.danger {
            background: #dc3545;
        }
        .output {
            background: white;
            padding: 15px;
            border: 1px solid #ccc;
            border-radius: 4px;
            margin: 10px 0;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        .product-item {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            background: white;
        }
        .product-item img {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: 4px;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
    </style>
</head>
<body>
    <h1>Recently Viewed Products - Demo Testing</h1>
    
    <div class="demo-section">
        <h2>1. localStorage Testing</h2>
        <p>Test localStorage functionality untuk recently viewed products.</p>
        
        <button class="button" onclick="addSampleProducts()">Add Sample Products</button>
        <button class="button secondary" onclick="viewLocalStorage()">View localStorage</button>
        <button class="button danger" onclick="clearLocalStorage()">Clear localStorage</button>
        
        <div id="localStorage-output" class="output"></div>
    </div>

    <div class="demo-section">
        <h2>2. Product Simulation</h2>
        <p>Simulasi kunjungan ke halaman produk untuk testing tracking.</p>
        
        <div class="product-grid">
            <div class="product-item">
                <img src="https://via.placeholder.com/200x150/007cba/white?text=Product+1" alt="Product 1">
                <h4>Sample Product 1</h4>
                <button class="button" onclick="visitProduct(101, 'Sample Product 1')">Visit Product</button>
            </div>
            <div class="product-item">
                <img src="https://via.placeholder.com/200x150/28a745/white?text=Product+2" alt="Product 2">
                <h4>Sample Product 2</h4>
                <button class="button" onclick="visitProduct(102, 'Sample Product 2')">Visit Product</button>
            </div>
            <div class="product-item">
                <img src="https://via.placeholder.com/200x150/dc3545/white?text=Product+3" alt="Product 3">
                <h4>Sample Product 3</h4>
                <button class="button" onclick="visitProduct(103, 'Sample Product 3')">Visit Product</button>
            </div>
            <div class="product-item">
                <img src="https://via.placeholder.com/200x150/ffc107/black?text=Product+4" alt="Product 4">
                <h4>Sample Product 4</h4>
                <button class="button" onclick="visitProduct(104, 'Sample Product 4')">Visit Product</button>
            </div>
        </div>
        
        <div id="visit-status"></div>
    </div>

    <div class="demo-section">
        <h2>3. Recently Viewed Display</h2>
        <p>Simulasi tampilan recently viewed products.</p>
        
        <button class="button" onclick="displayRecentlyViewed()">Display Recently Viewed</button>
        <button class="button secondary" onclick="displayRecentlyViewed(3)">Display Last 3</button>
        
        <div id="recently-viewed-display"></div>
    </div>

    <div class="demo-section">
        <h2>4. Browser Compatibility Test</h2>
        <p>Test kompatibilitas browser untuk localStorage dan JavaScript features.</p>
        
        <button class="button" onclick="testBrowserCompatibility()">Test Compatibility</button>
        
        <div id="compatibility-results"></div>
    </div>

    <script>
        // Sample product data
        const sampleProducts = [
            { id: 101, name: 'Sample Product 1', price: '$29.99', image: 'https://via.placeholder.com/200x150/007cba/white?text=Product+1' },
            { id: 102, name: 'Sample Product 2', price: '$39.99', image: 'https://via.placeholder.com/200x150/28a745/white?text=Product+2' },
            { id: 103, name: 'Sample Product 3', price: '$19.99', image: 'https://via.placeholder.com/200x150/dc3545/white?text=Product+3' },
            { id: 104, name: 'Sample Product 4', price: '$49.99', image: 'https://via.placeholder.com/200x150/ffc107/black?text=Product+4' },
            { id: 105, name: 'Sample Product 5', price: '$24.99', image: 'https://via.placeholder.com/200x150/6f42c1/white?text=Product+5' }
        ];

        // localStorage functions
        function getRecentlyViewedProducts() {
            try {
                const stored = localStorage.getItem('recently_viewed_products');
                return stored ? JSON.parse(stored) : [];
            } catch (e) {
                console.error('Error parsing recently viewed products:', e);
                return [];
            }
        }

        function addProductToRecentlyViewed(productId) {
            let recentlyViewed = getRecentlyViewedProducts();
            
            // Remove if already exists (avoid duplicates)
            recentlyViewed = recentlyViewed.filter(id => id !== productId);
            
            // Add to beginning
            recentlyViewed.unshift(productId);
            
            // Limit to 20 products
            if (recentlyViewed.length > 20) {
                recentlyViewed = recentlyViewed.slice(0, 20);
            }
            
            // Save back to localStorage
            localStorage.setItem('recently_viewed_products', JSON.stringify(recentlyViewed));
            
            return recentlyViewed;
        }

        // Demo functions
        function addSampleProducts() {
            const sampleIds = [101, 102, 103, 104, 105];
            sampleIds.forEach(id => addProductToRecentlyViewed(id));
            
            showStatus('success', 'Sample products added to localStorage!');
            viewLocalStorage();
        }

        function viewLocalStorage() {
            const products = getRecentlyViewedProducts();
            const output = document.getElementById('localStorage-output');
            
            if (products.length === 0) {
                output.textContent = 'localStorage is empty. Visit some products first!';
            } else {
                output.textContent = `Recently Viewed Products (${products.length} items):\n${JSON.stringify(products, null, 2)}`;
            }
        }

        function clearLocalStorage() {
            localStorage.removeItem('recently_viewed_products');
            showStatus('info', 'localStorage cleared!');
            viewLocalStorage();
        }

        function visitProduct(productId, productName) {
            addProductToRecentlyViewed(productId);
            showStatus('success', `Visited: ${productName} (ID: ${productId})`);
            viewLocalStorage();
        }

        function displayRecentlyViewed(limit = 6) {
            const productIds = getRecentlyViewedProducts().slice(0, limit);
            const display = document.getElementById('recently-viewed-display');
            
            if (productIds.length === 0) {
                display.innerHTML = '<div class="status info">No recently viewed products. Visit some products first!</div>';
                return;
            }

            let html = `<h4>Recently Viewed Products (${productIds.length} items)</h4><div class="product-grid">`;
            
            productIds.forEach(id => {
                const product = sampleProducts.find(p => p.id === id);
                if (product) {
                    html += `
                        <div class="product-item">
                            <img src="${product.image}" alt="${product.name}">
                            <h4>${product.name}</h4>
                            <p>${product.price}</p>
                        </div>
                    `;
                }
            });
            
            html += '</div>';
            display.innerHTML = html;
        }

        function testBrowserCompatibility() {
            const results = document.getElementById('compatibility-results');
            let html = '<h4>Browser Compatibility Results:</h4>';
            
            // Test localStorage
            const localStorageSupport = typeof(Storage) !== "undefined";
            html += `<p>localStorage Support: ${localStorageSupport ? '✅ Yes' : '❌ No'}</p>`;
            
            // Test JSON
            const jsonSupport = typeof JSON !== "undefined" && typeof JSON.parse === "function";
            html += `<p>JSON Support: ${jsonSupport ? '✅ Yes' : '❌ No'}</p>`;
            
            // Test Array methods
            const arrayMethodsSupport = Array.prototype.filter && Array.prototype.slice && Array.prototype.unshift;
            html += `<p>Array Methods Support: ${arrayMethodsSupport ? '✅ Yes' : '❌ No'}</p>`;
            
            // Test fetch API
            const fetchSupport = typeof fetch !== "undefined";
            html += `<p>Fetch API Support: ${fetchSupport ? '✅ Yes' : '❌ No'}</p>`;
            
            // Overall compatibility
            const overallCompatible = localStorageSupport && jsonSupport && arrayMethodsSupport;
            html += `<p><strong>Overall Compatibility: ${overallCompatible ? '✅ Compatible' : '❌ Not Compatible'}</strong></p>`;
            
            results.innerHTML = html;
        }

        function showStatus(type, message) {
            const statusDiv = document.getElementById('visit-status');
            statusDiv.innerHTML = `<div class="status ${type}">${message}</div>`;
            
            // Auto hide after 3 seconds
            setTimeout(() => {
                statusDiv.innerHTML = '';
            }, 3000);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            viewLocalStorage();
        });
    </script>
</body>
</html>
